<!DOCTYPE html>
<html lang="es">

{% include 'head.html' %}

<body>
    <div class="container">

        {% include 'encabezado.html' %}

        <div class="actualizacion">
            Se muestra información a partir de: <b>{{ fecha_desde }}</b>. Fecha Última Actualización: <b>{{
                fecha_actualizacion }}</b>
        </div>

        <hr>
        <div class="filtros-container">
            <div class="filtro-perfecto">
                <form action="/" method="GET" class="filtro-form">
                    <div class="filtro-group">
                        <span class="filtro-label">Fecha:</span>
                        <div class="filtro-controls">
                            <input type="date" id="fecha" name="fecha" class="filtro-date"
                                value="{{ request.args.get('fecha', '') }}">
                            <input type="hidden" name="titulo" value="{{ request.args.get('titulo', '') }}">
                            <button type="submit" class="filtro-btn filtro-submit" title="Aplicar filtro">
                                <svg viewBox="0 0 20 20" fill="currentColor" class="filtro-svg">
                                    <path fill-rule="evenodd"
                                        d="M3 3a1 1 0 011-1h12a1 1 0 011 1v3a1 1 0 01-.293.707L12 11.414V15a1 1 0 01-.293.707l-2 2A1 1 0 018 17v-5.586L3.293 6.707A1 1 0 013 6V3z"
                                        clip-rule="evenodd" />
                                </svg>
                            </button>
                            {% if request.args.get('fecha') %}
                            <a href="{{ url_for('index', titulo=request.args.get('titulo', '')) }}"
                                class="filtro-btn filtro-clear" title="Limpiar filtro">
                                <svg viewBox="0 0 20 20" fill="currentColor" class="filtro-svg">
                                    <path fill-rule="evenodd"
                                        d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                                        clip-rule="evenodd" />
                                </svg>
                            </a>
                            {% endif %}
                        </div>
                    </div>
                </form>
            </div>


            <div class="filtro-perfecto">
                <form action="/" method="GET" class="filtro-form">
                    <div class="filtro-group">
                        <span class="filtro-label">Título:</span>
                        <div class="filtro-controls">
                            <input type="text" id="titulo" name="titulo" placeholder="Ej: HUMANO, decreto"
                                class="filtro-title" value="{{ request.args.get('titulo', '') }}">
                            <input type="hidden" name="fecha" value="{{ request.args.get('fecha', '') }}">
                            <button type="submit" class="filtro-btn filtro-submit" title="Aplicar filtro">
                                <svg viewBox="0 0 20 20" fill="currentColor" class="filtro-svg">
                                    <path fill-rule="evenodd"
                                        d="M3 3a1 1 0 011-1h12a1 1 0 011 1v3a1 1 0 01-.293.707L12 11.414V15a1 1 0 01-.293.707l-2 2A1 1 0 018 17v-5.586L3.293 6.707A1 1 0 013 6V3z"
                                        clip-rule="evenodd" />
                                </svg>
                            </button>
                            {% if request.args.get('titulo') %}
                            <a href="{{ url_for('index', fecha=request.args.get('fecha', '')) }}"
                                class="filtro-btn filtro-clear" title="Limpiar filtro">
                                <svg viewBox="0 0 20 20" fill="currentColor" class="filtro-svg">
                                    <path fill-rule="evenodd"
                                        d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                                        clip-rule="evenodd" />
                                </svg>
                            </a>
                            {% endif %}
                        </div>
                    </div>
                </form>
            </div>
        </div>
        {% for aviso in avisos %}
        <div class="aviso">
            <div class="titulo">
                <a href="{{ aviso['Enlace'] }}" target="_blank">{{ aviso['Titulo'] }}</a>

            </div>

            <div class="fecha">
                Publicado el {{ aviso['FechaPublicacion'] }} (Modelo utilizado: {{ aviso['Modelo'] }})
            </div>
            <div class="TextoResumido" id="TextoResumido-{{ loop.index }}">
                {{ aviso['TextoResumidoCorto'] }}{% if aviso['TextoResumidoLargo'] %}<span id="more-{{ loop.index }}"
                    style="display:none;">{{ aviso['TextoResumidoLargo'] }}</span><span
                    id="dots-{{ loop.index }}">...</span>{% endif %}
            </div>
            {% if aviso['TextoResumidoLargo'] %}
            <button onclick="toggleTextoResumido({{ loop.index }})" id="btn-{{ loop.index }}">Mostrar más</button>
            {% endif %}

            {% include 'compartir_y_copiar.html' %}


        </div>
        {% endfor %}

        <div class="pagination">
            {% set current_fecha = request.args.get('fecha', '') %}
            {% set current_titulo = request.args.get('titulo', '') %}

            {% if pagina > 1 %}
            <a href="{{ url_for('index', pagina=pagina - 1, fecha=current_fecha, titulo=current_titulo) }}">&laquo;
                Anterior</a>
            {% endif %}
            <span>Página {{ pagina }} de {{ total_paginas }}</span>
            {% if pagina < total_paginas %} <a
                href="{{ url_for('index', pagina=pagina + 1, fecha=current_fecha, titulo=current_titulo) }}">Siguiente
                &raquo;</a>
                {% endif %}
        </div>

        {% include 'donar.html' %}

    </div>

    {% include 'ia_modal.html' %}

    <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>

</body>

</html>